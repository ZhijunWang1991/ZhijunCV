setwd('C:/blogdown/butter')
blogdown:::new_post_addin()
setwd('C:/blogdown/butter/content')
blogdown:::new_post_addin()
blogdown:::new_post_addin()
setwd("C:blogdown/butter/content")
blogdown:::new_post_addin()
setwd("C:blogdown/butter/content/cn")
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
data(iris)
data=iris[,-5]
labels=iris[,5]
pp=knn.double.cv(data,labels)
print(pp$Q2Y)
table(pp$Ypred,labels)
#
# data(MetRef)
# u=MetRef$data;
# u=u[,-which(colSums(u)==0)]
# u=normalization(u)$newXtrain
# u=scaling(u)$newXtrain
# pp=knn.double.cv(u,as.factor(MetRef$donor))
# print(pp$Q2Y)
# table(pp$Ypred,MetRef$donor)
install.packages("knn.double.cv")
install.packages("KODAMA")
install.packages("rgl")
install.packages("knn.cv")
install.packages("class")
library(knn.cv)
install.packages("knn.cv")
library(knn)
library(class)
train <- rbind(iris3[,,1], iris3[,,2], iris3[,,3])
cl <- factor(c(rep("s",50), rep("c",50), rep("v",50)))
knn.cv(train, cl, k = 3, prob = TRUE)
attributes(.Last.value)
knn.cv(train, cl, k = 3, prob = TRUE)
q <- knn.cv(train, cl, k = 3, prob = TRUE)
print(q)
View(q)
#library
library(Hmisc)
library(corrplot)
library(ggplot2)
#Set workspace
setwd('C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/Geo/')
###Read in the data
growing<- as.matrix(read.csv("Growingcondition.csv", row.names=1, header=T))
pulpHSI <- as.matrix(read.csv("pulpHSI.csv", row.names=1, header=T))
peelHSI <- as.matrix(read.csv("peelHSI.csv", row.names=1, header=T))
pulpchemicals <- as.matrix(read.csv("pulpchemicals.csv", row.names=1, header=T))
peelchemicals <- as.matrix(read.csv("peelchemicals.csv", row.names=1, header=T))
###Get correlation
t_pulpHSI <- t(pulpHSI)
t_peelHSI <- t(peelHSI)
t_pulpchemicals <- t(pulpchemicals)
t_peelchemicals <- t(peelchemicals)
t_growing <- t(growing)
cor_table1 <- cor(t_growing,t_pulpHSI)
sig1 <- rcorr(t_growing,t_pulpHSI,type = "pearson")
M1 <- corrplot(cor_table1,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig1$P[1:3,4:13], insig = "blank",sig.level = 0.05)
cor_table2 <- cor(t_growing,t_peelHSI)
sig2 <- rcorr(t_growing,t_peelHSI,type = "pearson")
M2 <- corrplot(cor_table2,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig2$P[1:3,4:14], insig = "blank",sig.level = 0.05)
cor_table3 <- cor(t_growing,t_pulpchemicals)
sig3 <- rcorr(t_growing,t_pulpchemicals,type = "pearson")
M3 <- corrplot(cor_table3,method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig3$P[1:3,4:9], insig = "blank",sig.level = 0.05)
cor_table4 <- cor(t_growing,t_peelchemicals)
sig4 <- rcorr(t_growing,t_peelchemicals,type = "pearson")
M4 <- corrplot(cor_table4, method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig4$P[1:3,4:9], insig = "blank",sig.level = 0.05)
##Plot HSI and chemicals
cor_table5 <- cor(t_pulpchemicals,t_pulpHSI)
sig5 <- rcorr(t_pulpchemicals,t_pulpHSI,type = "pearson")
M5 <- corrplot(cor_table5,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig5$P[1:6,7:16], insig = "blank",sig.level = 0.05)
cor_table6 <- cor(t_peelchemicals,t_peelHSI)
sig6 <- rcorr(t_peelchemicals,t_peelHSI,type = "pearson")
M6 <- corrplot(cor_table6,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig6$P[1:6,7:17], insig = "blank",sig.level = 0.05)
M5
#library
library(Hmisc)
library(corrplot)
library(ggplot2)
#Set workspace
setwd('C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/Geo/')
###Read in the data
growing<- as.matrix(read.csv("Growingcondition0706.csv", row.names=1, header=T))
pulpHSI <- as.matrix(read.csv("pulpHSI.csv", row.names=1, header=T))
peelHSI <- as.matrix(read.csv("peelHSI.csv", row.names=1, header=T))
pulpchemicals <- as.matrix(read.csv("pulpchemicals.csv", row.names=1, header=T))
peelchemicals <- as.matrix(read.csv("peelchemicals.csv", row.names=1, header=T))
###Get correlation
t_pulpHSI <- t(pulpHSI)
t_peelHSI <- t(peelHSI)
t_pulpchemicals <- t(pulpchemicals)
t_peelchemicals <- t(peelchemicals)
t_growing <- t(growing)
cor_table1 <- cor(t_growing,t_pulpHSI)
sig1 <- rcorr(t_growing,t_pulpHSI,type = "pearson")
M1 <- corrplot(cor_table1,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig1$P[1:3,4:13], insig = "blank",sig.level = 0.05)
cor_table2 <- cor(t_growing,t_peelHSI)
sig2 <- rcorr(t_growing,t_peelHSI,type = "pearson")
M2 <- corrplot(cor_table2,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig2$P[1:3,4:14], insig = "blank",sig.level = 0.05)
cor_table3 <- cor(t_growing,t_pulpchemicals)
sig3 <- rcorr(t_growing,t_pulpchemicals,type = "pearson")
M3 <- corrplot(cor_table3,method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig3$P[1:3,4:9], insig = "blank",sig.level = 0.05)
cor_table4 <- cor(t_growing,t_peelchemicals)
sig4 <- rcorr(t_growing,t_peelchemicals,type = "pearson")
M4 <- corrplot(cor_table4, method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig4$P[1:3,4:9], insig = "blank",sig.level = 0.05)
##Plot HSI and chemicals
cor_table5 <- cor(t_pulpchemicals,t_pulpHSI)
sig5 <- rcorr(t_pulpchemicals,t_pulpHSI,type = "pearson")
M5 <- corrplot(cor_table5,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig5$P[1:6,7:16], insig = "blank",sig.level = 0.05)
cor_table6 <- cor(t_peelchemicals,t_peelHSI)
sig6 <- rcorr(t_peelchemicals,t_peelHSI,type = "pearson")
M6 <- corrplot(cor_table6,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig6$P[1:6,7:17], insig = "blank",sig.level = 0.05)
#library
library(Hmisc)
library(corrplot)
library(ggplot2)
#Set workspace
setwd('C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/Geo/')
###Read in the data
growing<- as.matrix(read.csv("Growingcondition0706.csv", row.names=1, header=T))
pulpHSI <- as.matrix(read.csv("pulpHSI.csv", row.names=1, header=T))
peelHSI <- as.matrix(read.csv("peelHSI.csv", row.names=1, header=T))
pulpchemicals <- as.matrix(read.csv("pulpchemicals.csv", row.names=1, header=T))
peelchemicals <- as.matrix(read.csv("peelchemicals.csv", row.names=1, header=T))
###Get correlation
t_pulpHSI <- t(pulpHSI)
t_peelHSI <- t(peelHSI)
t_pulpchemicals <- t(pulpchemicals)
t_peelchemicals <- t(peelchemicals)
t_growing <- t(growing)
cor_table1 <- cor(t_growing,t_pulpHSI)
sig1 <- rcorr(t_growing,t_pulpHSI,type = "pearson")
M1 <- corrplot(cor_table1,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig1$P[1:3,4:13], insig = "blank",sig.level = 0.05)
cor_table2 <- cor(t_growing,t_peelHSI)
sig2 <- rcorr(t_growing,t_peelHSI,type = "pearson")
M2 <- corrplot(cor_table2,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig2$P[1:3,4:14], insig = "blank",sig.level = 0.05)
cor_table3 <- cor(t_growing,t_pulpchemicals)
sig3 <- rcorr(t_growing,t_pulpchemicals,type = "pearson")
M3 <- corrplot(cor_table3,method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig3$P[1:3,4:9], insig = "blank",sig.level = 0.05)
cor_table4 <- cor(t_growing,t_peelchemicals)
sig4 <- rcorr(t_growing,t_peelchemicals,type = "pearson")
M4 <- corrplot(cor_table4, method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig4$P[1:3,4:9], insig = "blank",sig.level = 0.05)
cor_table5 <- cor(t_pulpchemicals,t_pulpHSI)
sig5 <- rcorr(t_pulpchemicals,t_pulpHSI,type = "pearson")
M5 <- corrplot(cor_table5,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig5$P[1:6,7:16], insig = "blank",sig.level = 0.05)
cor_table6 <- cor(t_peelchemicals,t_peelHSI)
sig6 <- rcorr(t_peelchemicals,t_peelHSI,type = "pearson")
M6 <- corrplot(cor_table6,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig6$P[1:6,7:17], insig = "blank",sig.level = 0.05)
M3
##For significant ANOVA
#library
library(multcomp)
##set workspace
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/'
setwd(paste0(basefolder,file.path('carotene')))
##load dataset
peel <- read.csv("carotene_peel.csv")
View(peel)
##ANOVA
Carotene <- peel$Carotene
Farm <- peel$Farm
aggregate(Carotene, by =list(Farm), FUN=mean)
aggregate(Carotene, by =list(Farm), FUN=sd)
fit <- aov(Carotene ~ Farm)
summary(fit)
TukeyHSD(fit)
par(mar=c(5,4,6,2))
tuk <- glht(fit,linfct= mcp(Farm="Tukey"))
plot(cld(tuk,level=.05),col="lightgrey")
library(dplyr)
table <- group_by(peel, peel$Farm) %>%
summarise(
count = n(),
mean = mean(Carotene, na.rm = TRUE),
sd = sd(Carotene, na.rm = TRUE)
)
View(table)
setwd('c:/blogdown/butter/')
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
set("C:/blogdown/butter/content")
setwd("C:/blogdown/butter/content/")
blogdown:::new_post_addin()
library(tidyverse)
library(caret)
library(dslabs)
data(heights)
# define the outcome and predictors
y <- heights$sex
x <- heights$height
# generate training and test sets
set.seed(2, sample.kind = "Rounding") # if using R 3.5 or earlier, remove the sample.kind argument
test_index <- createDataPartition(y, times = 1, p = 0.5, list = FALSE)
test_set <- heights[test_index, ]
train_set <- heights[-test_index, ]
train_set
test_index
test_set
y_hat <- sample(c("Male", "Female"), length(test_index), replace = TRUE)
y_hat <- sample(c("Male", "Female"), length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex)
library(dslabs)
library(dslabs)
read_mnist()
data <- read_mnist()
View(data)
ncol(data)
ncol()
ncol(read_mnist())
mnist
# tabulate each combination of prediction and actual value
table(predicted = y_hat, actual = test_set$sex)
test_set %>%
mutate(y_hat = y_hat) %>%
group_by(sex) %>%
summarize(accuracy = mean(y_hat == sex))
prev <- mean(y == "Male")
confusionMatrix(data = y_hat, reference = test_set$sex)
data(heights)
# define the outcome and predictors
y <- heights$sex
x <- heights$height
# generate training and test sets
set.seed(2, sample.kind = "Rounding") # if using R 3.5 or earlier, remove the sample.kind argument
test_index <- createDataPartition(y, times = 1, p = 0.5, list = FALSE)
test_set <- heights[test_index, ]
train_set <- heights[-test_index, ]
# guess the outcome
y_hat <- sample(c("Male", "Female"), length(test_index), replace = TRUE)
y_hat <- sample(c("Male", "Female"), length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
# compute accuracy
mean(y_hat == test_set$sex)
heights %>% group_by(sex) %>% summarize(mean(height), sd(height))
y_hat <- ifelse(x > 62, "Male", "Female") %>% factor(levels = levels(test_set$sex))
mean(y == y_hat)
# examine the accuracy of 10 cutoffs
cutoff <- seq(61, 70)
accuracy <- map_dbl(cutoff, function(x){
y_hat <- ifelse(train_set$height > x, "Male", "Female") %>%
factor(levels = levels(test_set$sex))
mean(y_hat == train_set$sex)
})
data.frame(cutoff, accuracy) %>%
ggplot(aes(cutoff, accuracy)) +
geom_point() +
geom_line()
max(accuracy)
best_cutoff <- cutoff[which.max(accuracy)]
best_cutoff
y_hat <- ifelse(test_set$height > best_cutoff, "Male", "Female") %>%
factor(levels = levels(test_set$sex))
y_hat <- factor(y_hat)
mean(y_hat == test_set$sex)
# tabulate each combination of prediction and actual value
table(predicted = y_hat, actual = test_set$sex)
test_set %>%
mutate(y_hat = y_hat) %>%
group_by(sex) %>%
summarize(accuracy = mean(y_hat == sex))
prev <- mean(y == "Male")
confusionMatrix(data = y_hat, reference = test_set$sex)
setwd("C:/blogdown/butter")
blogdown:::new_post_addin()
blogdown:::new_post_addin()
setwd("C:/blogdown/butter/content/")
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
#load library
library(factoextra)
library(ggrepel)
library(ggplot2)
library(ggthemes)
#Set work space
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/'
setwd(paste0(basefolder,file.path('HSI')))
#Load files
pulp.data <- read.csv('pulp_pcaSG.csv')
View(pulp.data)
peel.data <- read.csv('Peel_pcaSG.csv')
View(peel.data)
pulp.pca <- prcomp(pulp.data[,6:203],ncomp = 3)
peel.pca <- prcomp(peel.data[,7:204],ncomp = 3)
g1 <- fviz_pca_ind(pulp.pca,axes = c(2,3),
geom.ind = "point",
fill.ind = pulp.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 10,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
lable = pulp.data$Farm,
repel = F,
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms",
ggtheme = theme_classic())+
xlab("PC2 (25.3%)")+ylab("PC3 (14.0%)")+
ggtitle("PCA_Pulp")+
theme(text = element_text(size = 50),
axis.title = element_text(size = 50),
axis.text = element_text(size = 50))
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 10,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme(text = element_text(size = 50),
axis.title = element_text(size = 50),
axis.text = element_text(size = 50))
g2
g1
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme(text = element_text(size = 50),
axis.title = element_text(size = 50),
axis.text = element_text(size = 50))
g2
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 10,
palette = c("#3A5FCD", "#FFC125", "#787878", "#FF4500", "#7EC0EE", "#473C8B", "#8B8B00", "#292929", "#8B3A3A", "#008B00"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme()
g2
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#3A5FCD", "#FFC125", "#787878", "#FF4500", "#7EC0EE", "#473C8B", "#8B8B00", "#292929", "#8B3A3A", "#008B00"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme()
g2
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme()
g2
#load library
library(factoextra)
library(ggrepel)
library(ggplot2)
library(ggthemes)
#Set work space
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/'
setwd(paste0(basefolder,file.path('HSI')))
#Load files
pulp.data <- read.csv('pulp_pcaSG.csv')
View(pulp.data)
peel.data <- read.csv('Peel_pcaSG.csv')
View(peel.data)
pulp.pca <- prcomp(pulp.data[,6:203],ncomp = 3)
peel.pca <- prcomp(peel.data[,7:204],ncomp = 3)
g1 <- fviz_pca_ind(pulp.pca,axes = c(2,3),
geom.ind = "point",
fill.ind = pulp.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
lable = pulp.data$Farm,
repel = F,
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms",
ggtheme = theme_classic())+
xlab("PC2 (25.3%)")+ylab("PC3 (14.0%)")+
ggtitle("PCA_Pulp")+
theme()
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms")+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme()
g1
g2
g1
g2
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 2,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
lable = peel.data$Farm,
repel = F,
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms",
ggtheme = theme_classic())+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme()
g2
g2 <- fviz_pca_ind(peel.pca,axes = c(1,2),
geom.ind = "point",
fill.ind = peel.data$Farm, col.ind = "black",
pointshape = 21, pointsize = 10,
palette = c("#CD0000", "#EE7600", "#FFFF00", "#008B45", "#5D478B", "#3A5FCD", "#9A32CD", "#97FFFF", "#000000", "#FF1493"),
lable = peel.data$Farm,
repel = F,
addEllipses = TRUE,
ellipse.type= "convex",
legend.title = "Farms",
ggtheme = theme_classic())+
xlab("PC1 (89.7%)")+ylab("PC2 (4.6%)")+
ggtitle("PCA_Peel")+
theme(text = element_text(size = 50),
axis.title = element_text(size = 50),
axis.text = element_text(size = 50))
g2
setwd('c:/blogdown/butter/content/')
blogdown:::new_post_addin()
