plot(dose, drugA, type="b",
pch=15, lty=1, col="red", ylim=c(0, 60),
main="Drug A vs. Drug B",
xlab="Drug Dosage", ylab="Drug Response")
lines(dose, drugB, type="b",
pch=17, lty=2, col="blue")
abline(h=c(30), lwd=1.5, lty=2, col="gray")
library(Hmisc)
minor.tick(nx=3, ny=3, tick.ratio=0.5)
legend("topleft", inset=.05, title="Drug Type", c("A","B")
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
par(opar)
legend("topleft", inset=.05, title="Drug Type", c("A","B")
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
legend("topleft", inset=.05, title="Drug Type", c("A","B"),
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
legend("topleft", inset=20, title="Drug Type", c("A","B"),
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
legend("topleft", inset=0.5, title="Drug Type", c("A","B"),
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
dose <- c(20, 30, 40, 45, 60)
drugA <- c(16, 20, 27, 40, 60)
drugB <- c(15, 18, 25, 31, 40)
opar <- par(no.readonly=TRUE)
par(lwd=2, cex=1.5, font.lab=2)
plot(dose, drugA, type="b",
pch=15, lty=1, col="red", ylim=c(0, 60),
main="Drug A vs. Drug B",
xlab="Drug Dosage", ylab="Drug Response")
lines(dose, drugB, type="b",
pch=17, lty=2, col="blue")
abline(h=c(30), lwd=1.5, lty=2, col="gray")
library(Hmisc)
minor.tick(nx=3, ny=3, tick.ratio=0.5)
legend("toplesf", inset=0.1, title="Drug Type", c("A","B"),
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
par(opar)
legend("topleft", inset=0.1, title="Drug Type", c("A","B"),
lty=c(1, 2), pch=c(15, 17), col=c("red", "blue"))
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
setwd("C:/blogdown/butter/content/")
help(plotmath)
demo(plotmath)
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::serve_site()
#load library
library(ggplot2)
library(factoextra)
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/Paper2/data_analysis/'
setwd(paste0(basefolder,file.path('model')))
pulp.data <- read.csv('pulp_modelSG.csv')
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/Paper2/data_analysis/'
setwd(paste0(basefolder,file.path('model')))
pulp.data <- read.csv('pulp_modelSG.csv')
peel.data <- read.csv('peel_modelSG.csv')
pulp <- pulp.data[,13:210]
pulp.pca <- prcomp(pulp, center = TRUE, scale = TRUE)
pulp.pca
pulp.pca$rotation
pulp.pca$center
pulp.pca$PC1
pulp.pca$scale
pulp.pca$sdev
pulp.pca$x
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = TRUE,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Farms") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Farms") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = F,
legend.title = "Farms") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
get_pca
get_eig(pulp.pca)
g1 <- fviz_pca_ind(pulp.pca, geom.ind = pulp.data$Farm,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Farms") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (31.0%)")+ylab("PC2 (649.9%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, label = "none", # hide individual labels
habillage = pulp.data$Farm, # color by groups
palette = c("#00AFBB", "#E7B800", "#FC4E07"),
addEllipses = TRUE) +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (31.0%)")+ylab("PC2 (649.9%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
colourpicker:::colourPickerAddin()
g1 <- fviz_pca_ind(pulp.pca, label = "none", # hide individual labels
habillage = pulp.data$Farm, # color by groups
palette = c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493",
"#DAA520", "#363636", "#00FF00", "#8B3A62", "#EE0000", "#FFFF00"),
addEllipses = TRUE) +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (31.0%)")+ylab("PC2 (649.9%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, label = "none", # hide individual labels
habillage = pulp.data$Farm, # color by groups
palette = c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493",
"#DAA520", "#363636", "#00FF00", "#8B3A62", "#EE0000", "#FFFF00"),
addEllipses = F) +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (31.0%)")+ylab("PC2 (649.9%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
fviz_pca_biplot(pulp.pca, repel = TRUE)
g1 <- fviz_pca_ind(pulp.pca, label = "none", # hide individual labels
habillage = pulp.data$Farm, # color by groups
palette = c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493",
"#DAA520", "#363636", "#00FF00", "#8B3A62", "#EE0000", "#FFFF00"),
addEllipses = F) +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (31.0%)")+ylab("PC2 (649.9%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/'
setwd(paste0(basefolder,file.path('HSI')))
g1
#load library
library(ggplot2)
library(factoextra)
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/'
setwd(paste0(basefolder,file.path('HSI')))
pulp.data <- read.csv('SG_pulp_costarica.csv')
peel.data <- read.csv('SG_peel_costarica.csv')
pulp <- pulp.data[,4:207]
peel <- peel.data[,4:207]
pulp.pca <- prcomp(pulp, center = TRUE, scale = TRUE)
peel.pca <- prcomp(peel, center = TRUE, scale = TRUE)
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Location,
col.ind = "black",
palette = "jco",
addEllipses = TRUE,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Costa Rica") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g2 <- fviz_pca_ind(peel.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = peel.data$Location,
col.ind = "black",
palette = "jco",
addEllipses = TRUE,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Costa Rica") +
xlab("PC1 (85.4%)")+ylab("PC2 (7.4%)")+
ggtitle("PCA of peel HSI") +
theme(plot.title = element_text(hjust = 0.5))
g2
save.image('pca.RData')
ggsave('PCA_pulp_colour.png',g1)
ggsave('PCA_peel_colour.png',g2)
g1
#library
library(Hmisc)
library(corrplot)
library(ggplot2)
#Set workspace
setwd('C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/Geo/')
###Read in the data
growing<- as.matrix(read.csv("Growingcondition.csv", row.names=1, header=T))
pulpHSI <- as.matrix(read.csv("pulpHSI.csv", row.names=1, header=T))
peelHSI <- as.matrix(read.csv("peelHSI.csv", row.names=1, header=T))
pulpchemicals <- as.matrix(read.csv("pulpchemicals.csv", row.names=1, header=T))
peelchemicals <- as.matrix(read.csv("peelchemicals.csv", row.names=1, header=T))
###Get correlation
t_pulpHSI <- t(pulpHSI)
t_peelHSI <- t(peelHSI)
t_pulpchemicals <- t(pulpchemicals)
t_peelchemicals <- t(peelchemicals)
t_growing <- t(growing)
cor_table1 <- cor(t_growing,t_pulpHSI)
sig1 <- rcorr(t_growing,t_pulpHSI,type = "pearson")
M1 <- corrplot(cor_table1,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig1$P[1:3,4:13], insig = "blank",sig.level = 0.05)
cor_table2 <- cor(t_growing,t_peelHSI)
sig2 <- rcorr(t_growing,t_peelHSI,type = "pearson")
M2 <- corrplot(cor_table2,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig2$P[1:3,4:14], insig = "blank",sig.level = 0.05)
cor_table3 <- cor(t_growing,t_pulpchemicals)
sig3 <- rcorr(t_growing,t_pulpchemicals,type = "pearson")
M3 <- corrplot(cor_table3,method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig3$P[1:3,4:9], insig = "blank",sig.level = 0.05)
cor_table4 <- cor(t_growing,t_peelchemicals)
sig4 <- rcorr(t_growing,t_peelchemicals,type = "pearson")
M4 <- corrplot(cor_table4, method = "color",tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig4$P[1:3,4:9], insig = "blank",sig.level = 0.05)
##Plot HSI and chemicals
cor_table5 <- cor(t_pulpchemicals,t_pulpHSI)
sig5 <- rcorr(t_pulpchemicals,t_pulpHSI,type = "pearson")
M5 <- corrplot(cor_table5,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig5$P[1:6,7:16], insig = "blank",sig.level = 0.05)
cor_table6 <- cor(t_peelchemicals,t_peelHSI)
sig6 <- rcorr(t_peelchemicals,t_peelHSI,type = "pearson")
M6 <- corrplot(cor_table6,method = "color", tl.col = "black", tl.srt = 45,
addCoef.col = "black",
p.mat = sig6$P[1:6,7:17], insig = "blank",sig.level = 0.05)
setwd(c:)
setwd(c:/)
setwd(C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/nCOV)
setwd('C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/nCOV')
library(nCOV)
install_github("GuangchuangYu/nCov2019")
remotes::install_github("GuangchuangYu/nCov2019")
remotes::install_github("GuangchuangYu/nCov2019")
.libPaths()
remotes::install_github("GuangchuangYu/nCov2019")
library(nCov2019)
##计算显著性差异
#library
library(multcomp)
##set workspace
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Rworkspace'
setwd(paste0(basefolder,file.path('database')))
##set workspace
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/'
setwd(paste0(basefolder,file.path('database')))
##load dataset
iris <- read.csv("iris.csv")
View(iris)
##ANOVA
sepal_length <- iris$sepal_length
Species <- iris$species
aggregate(sepal_length, by =list(Species), FUN=mean)
aggregate(sepal_length, by =list(Species), FUN=sd)
fit <- aov(sepal_length ~ Species)
summary(fit)
TukeyHSD(fit)
par(mar=c(5,4,6,2))
tuk <- glht(fit,linfct= mcp(Species="Tukey"))
plot(cld(tuk,level=.05),col="lightgrey")
library(dplyr)
table <- group_by(iris, iris$species) %>%
summarise(
count = n(),
mean = mean(sepal_length, na.rm = TRUE),
sd = sd(sepal_length, na.rm = TRUE)
)
View(table)
write.csv(table, file = "sepal_length.csv")
g1 <- ggplot(iris) +
aes(x = speal_length, y = sepal_width, colour = Species) +
geom_line(size = 1L) +
scale_color_hue() +
labs(x = "X", y = "Y") +
theme_base()+
theme(legend.position=c(0.8, 0.2))
library(ggplot2)
g1 <- ggplot(iris) +
aes(x = speal_length, y = sepal_width, colour = Species) +
geom_line(size = 1L) +
scale_color_hue() +
labs(x = "X", y = "Y") +
theme_base()+
theme(legend.position=c(0.8, 0.2))
library(ggthemes)
g1 <- ggplot(iris) +
aes(x = speal_length, y = sepal_width, colour = Species) +
geom_line(size = 1L) +
scale_color_hue() +
labs(x = "X", y = "Y") +
theme_base()+
theme(legend.position=c(0.8, 0.2))
g1
g1 <- ggplot(iris) +
aes(x = iris$speal_length, y = sepal_width, colour = Species) +
geom_line(size = 1L) +
scale_color_hue() +
labs(x = "X", y = "Y") +
theme_base()+
theme(legend.position=c(0.8, 0.2))
g1
g1 <- ggplot(iris) +
aes(x = iris$speal_length, y = sepal_width, colour = Species) +
scale_color_hue() +
labs(x = "X", y = "Y") +
theme_base()+
theme(legend.position=c(0.8, 0.2))
g1
plot(x, y, main = "Main title",
xlab = "X axis title", ylab = "Y axis title",
pch = 19, frame = FALSE)
x <- iris$sepal_length
y <- iris$sepal_width
plot(x, y, main = "Main title",
xlab = "X axis title", ylab = "Y axis title",
pch = 19, frame = FALSE)
plot(x, y, main = "XY-scatter plot",
xlab = "X axis title", ylab = "Y axis title",
pch = 19, frame = FALSE)
scatterplot <- plot(x, y, main = "XY-scatter plot",
xlab = "X axis title", ylab = "Y axis title",
pch = 19, frame = FALSE)
library(scatterplot3d)
library(FactoClass)
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/'
setwd(paste0(basefolder,file.path('Isotope')))
colors <- c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493", "#DAA520", "#363636", "#00FF00",
"#EE4000", "#87CEFF", "#36648B", "#FFFF00", "#8B3A3A", "#7B68EE", "#0000EE", "#000000")
colors <- colors[as.numeric(isotope$Farm)]
pulp <- scatterplot3d(isotope[,4:6], pch = 16, color = colors,
grid=FALSE, box=TRUE,
xlab = "C",
ylab = "N",
zlab = "O")
text(pulp$xyz.convert(isotope[, 4:6]), pos = 1,labels = isotope$Farm,
offset = 0.5,
cex= 0.7, col = "black")
leg.colors <- c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493", "#DAA520", "#363636", "#00FF00",
"#EE4000", "#87CEFF", "#36648B", "#FFFF00", "#8B3A3A", "#7B68EE", "#0000EE", "#000000")
leg.colors <- leg.colors[as.numeric(isotope$Farm)]
legend("bottom", legend = isotope$Farm,
col =  leg.colors,
pch = 16)
setwd(paste0(basefolder,file.path('isotope')))
colors <- c("#8A2BE2", "#FF7256", "#6E8B3D", "#FF1493", "#DAA520", "#363636", "#00FF00",
"#EE4000", "#87CEFF", "#36648B", "#FFFF00", "#8B3A3A", "#7B68EE", "#0000EE", "#000000")
colors <- colors[as.numeric(isotope$Farm)]
library(ggplot2)
library(factoextra)
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Rworkspace/HSI/'
setwd(paste0(basefolder,file.path('data')))
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis'
setwd(paste0(basefolder,file.path('HSI')))
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/'
setwd(paste0(basefolder,file.path('HSI')))
peel<- read.csv('pulp_pcaSG.csv')
pulp.data <- read.csv('pulp_pcaSG.csv')
head(pulp.data)
pulp <- pulp.data[,6:209]
pulp.pca <- prcomp(pulp, center = TRUE, scale = TRUE)
pulp.data <- read.csv('pulp_pcaSG.csv')
pulp <- pulp.data[,6:203]
pulp.pca <- prcomp(pulp, center = TRUE, scale = TRUE)
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Location,
col.ind = "black",
palette = "jco",
addEllipses = TRUE,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Costa Rica") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = TRUE,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Costa Rica") +
ggtitle("PCA of HSI pulp") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
pulp.pca$rotation
pulp.pca$x
pulp.pca
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = TRUE,
legend.title = "Farm") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = F,
legend.title = "Farm") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 15,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = F,
legend.title = "Farm") +
xlab("PC1 (90.4%)")+ylab("PC2 (6.5%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
pc1
PC1
pulp.pca(pc1)
pulp.pca$center
pulp.pca$scale
pulp.pca()
fviz_eig
get_eigenvalue
get_eigenvalue(PC1)
get_eig(pulp.pca)
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = F,
legend.title = "Farm") +
xlab("PC1 (44.05%)")+ylab("PC2 (67.10%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
#load library
library(ggplot2)
library(factoextra)
basefolder <- 'C:/Users/wang298/OneDrive - WageningenUR/Banana/paper2/data_analysis/'
setwd(paste0(basefolder,file.path('HSI')))
pulp.data <- read.csv('pulp_pcaSG.csv')
head(pulp.data)
pulp <- pulp.data[,6:203]
pulp.pca <- prcomp(pulp, center = TRUE, scale = TRUE)
get_eig(pulp.pca)
g1 <- fviz_pca_ind(pulp.pca, geom.ind = "point", pointshape = 21,
pointsize = 2,
fill.ind = pulp.data$Farm,
col.ind = "black",
palette = "jco",
addEllipses = F,
label = "var",
col.var = "black",
repel = F,
legend.title = "Farm") +
xlab("PC1 (44.05%)")+ylab("PC2 (67.10%)")+
theme(plot.title = element_text(hjust = 0.5))
g1
